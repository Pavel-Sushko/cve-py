import requests
from datetime import datetime, timedelta


API = {
    'ENDPOINT': 'https://services.nvd.nist.gov/rest/json/cves/2.0'
}
TODAY = datetime.now()
YESTERDAY = TODAY - timedelta(days=1)


def get_cves():
    response = requests.get(
        f'{API["ENDPOINT"]}?noRejected&pubStartDate={YESTERDAY.strftime("%Y-%m-%dT%H:%M:%S.%f")}&pubEndDate={TODAY.strftime("%Y-%m-%dT%H:%M:%S.%f")}')

    if response.status_code != 200:
        return None

    return response.json()['vulnerabilities']
